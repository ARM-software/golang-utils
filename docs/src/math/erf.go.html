<!DOCTYPE html>
<!--
-- Copyright (C) 2020-2021 Arm Limited or its affiliates and Contributors. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0
-->
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: erf.go in package math</title>
<link href="../../css/light-v0.4.0.css" rel="stylesheet">
<script src="../../jvs/golds-v0.4.0.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	erf.go

<span class="title">Belonging Package</span>
	<a href="../../pkg/math.html">math</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4],
input[id=r5]:checked ~pre label[for=r5],
input[id=r6]:checked ~pre label[for=r6],
input[id=r7]:checked ~pre label[for=r7],
input[id=r8]:checked ~pre label[for=r8],
input[id=r9]:checked ~pre label[for=r9],
input[id=r10]:checked ~pre label[for=r10],
input[id=r11]:checked ~pre label[for=r11],
input[id=r12]:checked ~pre label[for=r12],
input[id=r13]:checked ~pre label[for=r13],
input[id=r14]:checked ~pre label[for=r14],
input[id=r15]:checked ~pre label[for=r15],
input[id=r16]:checked ~pre label[for=r16],
input[id=r17]:checked ~pre label[for=r17],
input[id=r18]:checked ~pre label[for=r18],
input[id=r19]:checked ~pre label[for=r19],
input[id=r20]:checked ~pre label[for=r20],
input[id=r21]:checked ~pre label[for=r21],
input[id=r22]:checked ~pre label[for=r22],
input[id=r23]:checked ~pre label[for=r23],
input[id=r24]:checked ~pre label[for=r24],
input[id=r25]:checked ~pre label[for=r25],
input[id=r26]:checked ~pre label[for=r26],
input[id=r27]:checked ~pre label[for=r27],
input[id=r28]:checked ~pre label[for=r28],
input[id=r29]:checked ~pre label[for=r29],
input[id=r30]:checked ~pre label[for=r30],
input[id=r31]:checked ~pre label[for=r31],
input[id=r32]:checked ~pre label[for=r32],
input[id=r33]:checked ~pre label[for=r33],
input[id=r34]:checked ~pre label[for=r34],
input[id=r35]:checked ~pre label[for=r35],
input[id=r36]:checked ~pre label[for=r36],
input[id=r37]:checked ~pre label[for=r37],
input[id=r38]:checked ~pre label[for=r38]
{background: #226; color: #ff8;}
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="r5" type="radio" name="g"/>
<input id="r6" type="radio" name="g"/>
<input id="r7" type="radio" name="g"/>
<input id="r8" type="radio" name="g"/>
<input id="r9" type="radio" name="g"/>
<input id="r10" type="radio" name="g"/>
<input id="r11" type="radio" name="g"/>
<input id="r12" type="radio" name="g"/>
<input id="r13" type="radio" name="g"/>
<input id="r14" type="radio" name="g"/>
<input id="r15" type="radio" name="g"/>
<input id="r16" type="radio" name="g"/>
<input id="r17" type="radio" name="g"/>
<input id="r18" type="radio" name="g"/>
<input id="r19" type="radio" name="g"/>
<input id="r20" type="radio" name="g"/>
<input id="r21" type="radio" name="g"/>
<input id="r22" type="radio" name="g"/>
<input id="r23" type="radio" name="g"/>
<input id="r24" type="radio" name="g"/>
<input id="r25" type="radio" name="g"/>
<input id="r26" type="radio" name="g"/>
<input id="r27" type="radio" name="g"/>
<input id="r28" type="radio" name="g"/>
<input id="r29" type="radio" name="g"/>
<input id="r30" type="radio" name="g"/>
<input id="r31" type="radio" name="g"/>
<input id="r32" type="radio" name="g"/>
<input id="r33" type="radio" name="g"/>
<input id="r34" type="radio" name="g"/>
<input id="r35" type="radio" name="g"/>
<input id="r36" type="radio" name="g"/>
<input id="r37" type="radio" name="g"/>
<input id="r38" type="radio" name="g"/>

<pre class="line-numbers">
<span class="codeline" id="line-1"><code><span class="comment">// Copyright 2010 The Go Authors. All rights reserved.</span></code></span>
<span class="codeline" id="line-2"><code><span class="comment">// Use of this source code is governed by a BSD-style</span></code></span>
<span class="codeline" id="line-3"><code><span class="comment">// license that can be found in the LICENSE file.</span></code></span>
<span class="codeline" id="line-4"><code></code></span>
<span class="codeline" id="line-5"><code><span class="keyword">package</span> math</code></span>
<span class="codeline" id="line-6"><code></code></span>
<span class="codeline" id="line-7"><code><span class="comment">/*</span></code></span>
<span class="codeline" id="line-8"><code><span class="comment">	Floating-point error function and complementary error function.</span></code></span>
<span class="codeline" id="line-9"><code><span class="comment">*/</span></code></span>
<span class="codeline" id="line-10"><code></code></span>
<span class="codeline" id="line-11"><code><span class="comment">// The original C code and the long comment below are</span></code></span>
<span class="codeline" id="line-12"><code><span class="comment">// from FreeBSD's /usr/src/lib/msun/src/s_erf.c and</span></code></span>
<span class="codeline" id="line-13"><code><span class="comment">// came with this notice. The go code is a simplified</span></code></span>
<span class="codeline" id="line-14"><code><span class="comment">// version of the original C.</span></code></span>
<span class="codeline" id="line-15"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-16"><code><span class="comment">// ====================================================</span></code></span>
<span class="codeline" id="line-17"><code><span class="comment">// Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.</span></code></span>
<span class="codeline" id="line-18"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-19"><code><span class="comment">// Developed at SunPro, a Sun Microsystems, Inc. business.</span></code></span>
<span class="codeline" id="line-20"><code><span class="comment">// Permission to use, copy, modify, and distribute this</span></code></span>
<span class="codeline" id="line-21"><code><span class="comment">// software is freely granted, provided that this notice</span></code></span>
<span class="codeline" id="line-22"><code><span class="comment">// is preserved.</span></code></span>
<span class="codeline" id="line-23"><code><span class="comment">// ====================================================</span></code></span>
<span class="codeline" id="line-24"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-25"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-26"><code><span class="comment">// double erf(double x)</span></code></span>
<span class="codeline" id="line-27"><code><span class="comment">// double erfc(double x)</span></code></span>
<span class="codeline" id="line-28"><code><span class="comment">//                           x</span></code></span>
<span class="codeline" id="line-29"><code><span class="comment">//                    2      |\</span></code></span>
<span class="codeline" id="line-30"><code><span class="comment">//     erf(x)  =  ---------  | exp(-t*t)dt</span></code></span>
<span class="codeline" id="line-31"><code><span class="comment">//                 sqrt(pi) \|</span></code></span>
<span class="codeline" id="line-32"><code><span class="comment">//                           0</span></code></span>
<span class="codeline" id="line-33"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-34"><code><span class="comment">//     erfc(x) =  1-erf(x)</span></code></span>
<span class="codeline" id="line-35"><code><span class="comment">//  Note that</span></code></span>
<span class="codeline" id="line-36"><code><span class="comment">//              erf(-x) = -erf(x)</span></code></span>
<span class="codeline" id="line-37"><code><span class="comment">//              erfc(-x) = 2 - erfc(x)</span></code></span>
<span class="codeline" id="line-38"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-39"><code><span class="comment">// Method:</span></code></span>
<span class="codeline" id="line-40"><code><span class="comment">//      1. For |x| in [0, 0.84375]</span></code></span>
<span class="codeline" id="line-41"><code><span class="comment">//          erf(x)  = x + x*R(x**2)</span></code></span>
<span class="codeline" id="line-42"><code><span class="comment">//          erfc(x) = 1 - erf(x)           if x in [-.84375,0.25]</span></code></span>
<span class="codeline" id="line-43"><code><span class="comment">//                  = 0.5 + ((0.5-x)-x*R)  if x in [0.25,0.84375]</span></code></span>
<span class="codeline" id="line-44"><code><span class="comment">//         where R = P/Q where P is an odd poly of degree 8 and</span></code></span>
<span class="codeline" id="line-45"><code><span class="comment">//         Q is an odd poly of degree 10.</span></code></span>
<span class="codeline" id="line-46"><code><span class="comment">//                                               -57.90</span></code></span>
<span class="codeline" id="line-47"><code><span class="comment">//                      | R - (erf(x)-x)/x | &lt;= 2</span></code></span>
<span class="codeline" id="line-48"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-49"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-50"><code><span class="comment">//         Remark. The formula is derived by noting</span></code></span>
<span class="codeline" id="line-51"><code><span class="comment">//          erf(x) = (2/sqrt(pi))*(x - x**3/3 + x**5/10 - x**7/42 + ....)</span></code></span>
<span class="codeline" id="line-52"><code><span class="comment">//         and that</span></code></span>
<span class="codeline" id="line-53"><code><span class="comment">//          2/sqrt(pi) = 1.128379167095512573896158903121545171688</span></code></span>
<span class="codeline" id="line-54"><code><span class="comment">//         is close to one. The interval is chosen because the fix</span></code></span>
<span class="codeline" id="line-55"><code><span class="comment">//         point of erf(x) is near 0.6174 (i.e., erf(x)=x when x is</span></code></span>
<span class="codeline" id="line-56"><code><span class="comment">//         near 0.6174), and by some experiment, 0.84375 is chosen to</span></code></span>
<span class="codeline" id="line-57"><code><span class="comment">//         guarantee the error is less than one ulp for erf.</span></code></span>
<span class="codeline" id="line-58"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-59"><code><span class="comment">//      2. For |x| in [0.84375,1.25], let s = |x| - 1, and</span></code></span>
<span class="codeline" id="line-60"><code><span class="comment">//         c = 0.84506291151 rounded to single (24 bits)</span></code></span>
<span class="codeline" id="line-61"><code><span class="comment">//              erf(x)  = sign(x) * (c  + P1(s)/Q1(s))</span></code></span>
<span class="codeline" id="line-62"><code><span class="comment">//              erfc(x) = (1-c)  - P1(s)/Q1(s) if x &gt; 0</span></code></span>
<span class="codeline" id="line-63"><code><span class="comment">//                        1+(c+P1(s)/Q1(s))    if x &lt; 0</span></code></span>
<span class="codeline" id="line-64"><code><span class="comment">//              |P1/Q1 - (erf(|x|)-c)| &lt;= 2**-59.06</span></code></span>
<span class="codeline" id="line-65"><code><span class="comment">//         Remark: here we use the taylor series expansion at x=1.</span></code></span>
<span class="codeline" id="line-66"><code><span class="comment">//              erf(1+s) = erf(1) + s*Poly(s)</span></code></span>
<span class="codeline" id="line-67"><code><span class="comment">//                       = 0.845.. + P1(s)/Q1(s)</span></code></span>
<span class="codeline" id="line-68"><code><span class="comment">//         That is, we use rational approximation to approximate</span></code></span>
<span class="codeline" id="line-69"><code><span class="comment">//                      erf(1+s) - (c = (single)0.84506291151)</span></code></span>
<span class="codeline" id="line-70"><code><span class="comment">//         Note that |P1/Q1|&lt; 0.078 for x in [0.84375,1.25]</span></code></span>
<span class="codeline" id="line-71"><code><span class="comment">//         where</span></code></span>
<span class="codeline" id="line-72"><code><span class="comment">//              P1(s) = degree 6 poly in s</span></code></span>
<span class="codeline" id="line-73"><code><span class="comment">//              Q1(s) = degree 6 poly in s</span></code></span>
<span class="codeline" id="line-74"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-75"><code><span class="comment">//      3. For x in [1.25,1/0.35(~2.857143)],</span></code></span>
<span class="codeline" id="line-76"><code><span class="comment">//              erfc(x) = (1/x)*exp(-x*x-0.5625+R1/S1)</span></code></span>
<span class="codeline" id="line-77"><code><span class="comment">//              erf(x)  = 1 - erfc(x)</span></code></span>
<span class="codeline" id="line-78"><code><span class="comment">//         where</span></code></span>
<span class="codeline" id="line-79"><code><span class="comment">//              R1(z) = degree 7 poly in z, (z=1/x**2)</span></code></span>
<span class="codeline" id="line-80"><code><span class="comment">//              S1(z) = degree 8 poly in z</span></code></span>
<span class="codeline" id="line-81"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-82"><code><span class="comment">//      4. For x in [1/0.35,28]</span></code></span>
<span class="codeline" id="line-83"><code><span class="comment">//              erfc(x) = (1/x)*exp(-x*x-0.5625+R2/S2) if x &gt; 0</span></code></span>
<span class="codeline" id="line-84"><code><span class="comment">//                      = 2.0 - (1/x)*exp(-x*x-0.5625+R2/S2) if -6&lt;x&lt;0</span></code></span>
<span class="codeline" id="line-85"><code><span class="comment">//                      = 2.0 - tiny            (if x &lt;= -6)</span></code></span>
<span class="codeline" id="line-86"><code><span class="comment">//              erf(x)  = sign(x)*(1.0 - erfc(x)) if x &lt; 6, else</span></code></span>
<span class="codeline" id="line-87"><code><span class="comment">//              erf(x)  = sign(x)*(1.0 - tiny)</span></code></span>
<span class="codeline" id="line-88"><code><span class="comment">//         where</span></code></span>
<span class="codeline" id="line-89"><code><span class="comment">//              R2(z) = degree 6 poly in z, (z=1/x**2)</span></code></span>
<span class="codeline" id="line-90"><code><span class="comment">//              S2(z) = degree 7 poly in z</span></code></span>
<span class="codeline" id="line-91"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-92"><code><span class="comment">//      Note1:</span></code></span>
<span class="codeline" id="line-93"><code><span class="comment">//         To compute exp(-x*x-0.5625+R/S), let s be a single</span></code></span>
<span class="codeline" id="line-94"><code><span class="comment">//         precision number and s := x; then</span></code></span>
<span class="codeline" id="line-95"><code><span class="comment">//              -x*x = -s*s + (s-x)*(s+x)</span></code></span>
<span class="codeline" id="line-96"><code><span class="comment">//              exp(-x*x-0.5626+R/S) =</span></code></span>
<span class="codeline" id="line-97"><code><span class="comment">//                      exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span></code></span>
<span class="codeline" id="line-98"><code><span class="comment">//      Note2:</span></code></span>
<span class="codeline" id="line-99"><code><span class="comment">//         Here 4 and 5 make use of the asymptotic series</span></code></span>
<span class="codeline" id="line-100"><code><span class="comment">//                        exp(-x*x)</span></code></span>
<span class="codeline" id="line-101"><code><span class="comment">//              erfc(x) ~ ---------- * ( 1 + Poly(1/x**2) )</span></code></span>
<span class="codeline" id="line-102"><code><span class="comment">//                        x*sqrt(pi)</span></code></span>
<span class="codeline" id="line-103"><code><span class="comment">//         We use rational approximation to approximate</span></code></span>
<span class="codeline" id="line-104"><code><span class="comment">//              g(s)=f(1/x**2) = log(erfc(x)*x) - x*x + 0.5625</span></code></span>
<span class="codeline" id="line-105"><code><span class="comment">//         Here is the error bound for R1/S1 and R2/S2</span></code></span>
<span class="codeline" id="line-106"><code><span class="comment">//              |R1/S1 - f(x)|  &lt; 2**(-62.57)</span></code></span>
<span class="codeline" id="line-107"><code><span class="comment">//              |R2/S2 - f(x)|  &lt; 2**(-61.52)</span></code></span>
<span class="codeline" id="line-108"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-109"><code><span class="comment">//      5. For inf &gt; x &gt;= 28</span></code></span>
<span class="codeline" id="line-110"><code><span class="comment">//              erf(x)  = sign(x) *(1 - tiny)  (raise inexact)</span></code></span>
<span class="codeline" id="line-111"><code><span class="comment">//              erfc(x) = tiny*tiny (raise underflow) if x &gt; 0</span></code></span>
<span class="codeline" id="line-112"><code><span class="comment">//                      = 2 - tiny if x&lt;0</span></code></span>
<span class="codeline" id="line-113"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-114"><code><span class="comment">//      7. Special case:</span></code></span>
<span class="codeline" id="line-115"><code><span class="comment">//              erf(0)  = 0, erf(inf)  = 1, erf(-inf) = -1,</span></code></span>
<span class="codeline" id="line-116"><code><span class="comment">//              erfc(0) = 1, erfc(inf) = 0, erfc(-inf) = 2,</span></code></span>
<span class="codeline" id="line-117"><code><span class="comment">//              erfc/erf(NaN) is NaN</span></code></span>
<span class="codeline" id="line-118"><code></code></span>
<span class="codeline" id="line-119"><code><span class="keyword">const</span> (</code></span>
<span class="codeline" id="line-120"><code>	<a href="../../pkg/math.html#name-erx" class="ident">erx</a> = <span class="lit-number">8.45062911510467529297e-01</span> <span class="comment">// 0x3FEB0AC160000000</span></code></span>
<span class="codeline" id="line-121"><code>	<span class="comment">// Coefficients for approximation to  erf in [0, 0.84375]</span></code></span>
<span class="codeline" id="line-122"><code>	<a href="../../pkg/math.html#name-efx" class="ident">efx</a>  = <span class="lit-number">1.28379167095512586316e-01</span>  <span class="comment">// 0x3FC06EBA8214DB69</span></code></span>
<span class="codeline" id="line-123"><code>	<a href="../../pkg/math.html#name-efx8" class="ident">efx8</a> = <span class="lit-number">1.02703333676410069053e+00</span>  <span class="comment">// 0x3FF06EBA8214DB69</span></code></span>
<span class="codeline" id="line-124"><code>	<a href="../../pkg/math.html#name-pp0" class="ident">pp0</a>  = <span class="lit-number">1.28379167095512558561e-01</span>  <span class="comment">// 0x3FC06EBA8214DB68</span></code></span>
<span class="codeline" id="line-125"><code>	<a href="../../pkg/math.html#name-pp1" class="ident">pp1</a>  = -<span class="lit-number">3.25042107247001499370e-01</span> <span class="comment">// 0xBFD4CD7D691CB913</span></code></span>
<span class="codeline" id="line-126"><code>	<a href="../../pkg/math.html#name-pp2" class="ident">pp2</a>  = -<span class="lit-number">2.84817495755985104766e-02</span> <span class="comment">// 0xBF9D2A51DBD7194F</span></code></span>
<span class="codeline" id="line-127"><code>	<a href="../../pkg/math.html#name-pp3" class="ident">pp3</a>  = -<span class="lit-number">5.77027029648944159157e-03</span> <span class="comment">// 0xBF77A291236668E4</span></code></span>
<span class="codeline" id="line-128"><code>	<a href="../../pkg/math.html#name-pp4" class="ident">pp4</a>  = -<span class="lit-number">2.37630166566501626084e-05</span> <span class="comment">// 0xBEF8EAD6120016AC</span></code></span>
<span class="codeline" id="line-129"><code>	<a href="../../pkg/math.html#name-qq1" class="ident">qq1</a>  = <span class="lit-number">3.97917223959155352819e-01</span>  <span class="comment">// 0x3FD97779CDDADC09</span></code></span>
<span class="codeline" id="line-130"><code>	<a href="../../pkg/math.html#name-qq2" class="ident">qq2</a>  = <span class="lit-number">6.50222499887672944485e-02</span>  <span class="comment">// 0x3FB0A54C5536CEBA</span></code></span>
<span class="codeline" id="line-131"><code>	<a href="../../pkg/math.html#name-qq3" class="ident">qq3</a>  = <span class="lit-number">5.08130628187576562776e-03</span>  <span class="comment">// 0x3F74D022C4D36B0F</span></code></span>
<span class="codeline" id="line-132"><code>	<a href="../../pkg/math.html#name-qq4" class="ident">qq4</a>  = <span class="lit-number">1.32494738004321644526e-04</span>  <span class="comment">// 0x3F215DC9221C1A10</span></code></span>
<span class="codeline" id="line-133"><code>	<a href="../../pkg/math.html#name-qq5" class="ident">qq5</a>  = -<span class="lit-number">3.96022827877536812320e-06</span> <span class="comment">// 0xBED09C4342A26120</span></code></span>
<span class="codeline" id="line-134"><code>	<span class="comment">// Coefficients for approximation to  erf  in [0.84375, 1.25]</span></code></span>
<span class="codeline" id="line-135"><code>	<a href="../../pkg/math.html#name-pa0" class="ident">pa0</a> = -<span class="lit-number">2.36211856075265944077e-03</span> <span class="comment">// 0xBF6359B8BEF77538</span></code></span>
<span class="codeline" id="line-136"><code>	<a href="../../pkg/math.html#name-pa1" class="ident">pa1</a> = <span class="lit-number">4.14856118683748331666e-01</span>  <span class="comment">// 0x3FDA8D00AD92B34D</span></code></span>
<span class="codeline" id="line-137"><code>	<a href="../../pkg/math.html#name-pa2" class="ident">pa2</a> = -<span class="lit-number">3.72207876035701323847e-01</span> <span class="comment">// 0xBFD7D240FBB8C3F1</span></code></span>
<span class="codeline" id="line-138"><code>	<a href="../../pkg/math.html#name-pa3" class="ident">pa3</a> = <span class="lit-number">3.18346619901161753674e-01</span>  <span class="comment">// 0x3FD45FCA805120E4</span></code></span>
<span class="codeline" id="line-139"><code>	<a href="../../pkg/math.html#name-pa4" class="ident">pa4</a> = -<span class="lit-number">1.10894694282396677476e-01</span> <span class="comment">// 0xBFBC63983D3E28EC</span></code></span>
<span class="codeline" id="line-140"><code>	<a href="../../pkg/math.html#name-pa5" class="ident">pa5</a> = <span class="lit-number">3.54783043256182359371e-02</span>  <span class="comment">// 0x3FA22A36599795EB</span></code></span>
<span class="codeline" id="line-141"><code>	<a href="../../pkg/math.html#name-pa6" class="ident">pa6</a> = -<span class="lit-number">2.16637559486879084300e-03</span> <span class="comment">// 0xBF61BF380A96073F</span></code></span>
<span class="codeline" id="line-142"><code>	<a href="../../pkg/math.html#name-qa1" class="ident">qa1</a> = <span class="lit-number">1.06420880400844228286e-01</span>  <span class="comment">// 0x3FBB3E6618EEE323</span></code></span>
<span class="codeline" id="line-143"><code>	<a href="../../pkg/math.html#name-qa2" class="ident">qa2</a> = <span class="lit-number">5.40397917702171048937e-01</span>  <span class="comment">// 0x3FE14AF092EB6F33</span></code></span>
<span class="codeline" id="line-144"><code>	<a href="../../pkg/math.html#name-qa3" class="ident">qa3</a> = <span class="lit-number">7.18286544141962662868e-02</span>  <span class="comment">// 0x3FB2635CD99FE9A7</span></code></span>
<span class="codeline" id="line-145"><code>	<a href="../../pkg/math.html#name-qa4" class="ident">qa4</a> = <span class="lit-number">1.26171219808761642112e-01</span>  <span class="comment">// 0x3FC02660E763351F</span></code></span>
<span class="codeline" id="line-146"><code>	<a href="../../pkg/math.html#name-qa5" class="ident">qa5</a> = <span class="lit-number">1.36370839120290507362e-02</span>  <span class="comment">// 0x3F8BEDC26B51DD1C</span></code></span>
<span class="codeline" id="line-147"><code>	<a href="../../pkg/math.html#name-qa6" class="ident">qa6</a> = <span class="lit-number">1.19844998467991074170e-02</span>  <span class="comment">// 0x3F888B545735151D</span></code></span>
<span class="codeline" id="line-148"><code>	<span class="comment">// Coefficients for approximation to  erfc in [1.25, 1/0.35]</span></code></span>
<span class="codeline" id="line-149"><code>	<a href="../../pkg/math.html#name-ra0" class="ident">ra0</a> = -<span class="lit-number">9.86494403484714822705e-03</span> <span class="comment">// 0xBF843412600D6435</span></code></span>
<span class="codeline" id="line-150"><code>	<a href="../../pkg/math.html#name-ra1" class="ident">ra1</a> = -<span class="lit-number">6.93858572707181764372e-01</span> <span class="comment">// 0xBFE63416E4BA7360</span></code></span>
<span class="codeline" id="line-151"><code>	<a href="../../pkg/math.html#name-ra2" class="ident">ra2</a> = -<span class="lit-number">1.05586262253232909814e+01</span> <span class="comment">// 0xC0251E0441B0E726</span></code></span>
<span class="codeline" id="line-152"><code>	<a href="../../pkg/math.html#name-ra3" class="ident">ra3</a> = -<span class="lit-number">6.23753324503260060396e+01</span> <span class="comment">// 0xC04F300AE4CBA38D</span></code></span>
<span class="codeline" id="line-153"><code>	<a href="../../pkg/math.html#name-ra4" class="ident">ra4</a> = -<span class="lit-number">1.62396669462573470355e+02</span> <span class="comment">// 0xC0644CB184282266</span></code></span>
<span class="codeline" id="line-154"><code>	<a href="../../pkg/math.html#name-ra5" class="ident">ra5</a> = -<span class="lit-number">1.84605092906711035994e+02</span> <span class="comment">// 0xC067135CEBCCABB2</span></code></span>
<span class="codeline" id="line-155"><code>	<a href="../../pkg/math.html#name-ra6" class="ident">ra6</a> = -<span class="lit-number">8.12874355063065934246e+01</span> <span class="comment">// 0xC054526557E4D2F2</span></code></span>
<span class="codeline" id="line-156"><code>	<a href="../../pkg/math.html#name-ra7" class="ident">ra7</a> = -<span class="lit-number">9.81432934416914548592e+00</span> <span class="comment">// 0xC023A0EFC69AC25C</span></code></span>
<span class="codeline" id="line-157"><code>	<a href="../../pkg/math.html#name-sa1" class="ident">sa1</a> = <span class="lit-number">1.96512716674392571292e+01</span>  <span class="comment">// 0x4033A6B9BD707687</span></code></span>
<span class="codeline" id="line-158"><code>	<a href="../../pkg/math.html#name-sa2" class="ident">sa2</a> = <span class="lit-number">1.37657754143519042600e+02</span>  <span class="comment">// 0x4061350C526AE721</span></code></span>
<span class="codeline" id="line-159"><code>	<a href="../../pkg/math.html#name-sa3" class="ident">sa3</a> = <span class="lit-number">4.34565877475229228821e+02</span>  <span class="comment">// 0x407B290DD58A1A71</span></code></span>
<span class="codeline" id="line-160"><code>	<a href="../../pkg/math.html#name-sa4" class="ident">sa4</a> = <span class="lit-number">6.45387271733267880336e+02</span>  <span class="comment">// 0x40842B1921EC2868</span></code></span>
<span class="codeline" id="line-161"><code>	<a href="../../pkg/math.html#name-sa5" class="ident">sa5</a> = <span class="lit-number">4.29008140027567833386e+02</span>  <span class="comment">// 0x407AD02157700314</span></code></span>
<span class="codeline" id="line-162"><code>	<a href="../../pkg/math.html#name-sa6" class="ident">sa6</a> = <span class="lit-number">1.08635005541779435134e+02</span>  <span class="comment">// 0x405B28A3EE48AE2C</span></code></span>
<span class="codeline" id="line-163"><code>	<a href="../../pkg/math.html#name-sa7" class="ident">sa7</a> = <span class="lit-number">6.57024977031928170135e+00</span>  <span class="comment">// 0x401A47EF8E484A93</span></code></span>
<span class="codeline" id="line-164"><code>	<a href="../../pkg/math.html#name-sa8" class="ident">sa8</a> = -<span class="lit-number">6.04244152148580987438e-02</span> <span class="comment">// 0xBFAEEFF2EE749A62</span></code></span>
<span class="codeline" id="line-165"><code>	<span class="comment">// Coefficients for approximation to  erfc in [1/.35, 28]</span></code></span>
<span class="codeline" id="line-166"><code>	<a href="../../pkg/math.html#name-rb0" class="ident">rb0</a> = -<span class="lit-number">9.86494292470009928597e-03</span> <span class="comment">// 0xBF84341239E86F4A</span></code></span>
<span class="codeline" id="line-167"><code>	<a href="../../pkg/math.html#name-rb1" class="ident">rb1</a> = -<span class="lit-number">7.99283237680523006574e-01</span> <span class="comment">// 0xBFE993BA70C285DE</span></code></span>
<span class="codeline" id="line-168"><code>	<a href="../../pkg/math.html#name-rb2" class="ident">rb2</a> = -<span class="lit-number">1.77579549177547519889e+01</span> <span class="comment">// 0xC031C209555F995A</span></code></span>
<span class="codeline" id="line-169"><code>	<a href="../../pkg/math.html#name-rb3" class="ident">rb3</a> = -<span class="lit-number">1.60636384855821916062e+02</span> <span class="comment">// 0xC064145D43C5ED98</span></code></span>
<span class="codeline" id="line-170"><code>	<a href="../../pkg/math.html#name-rb4" class="ident">rb4</a> = -<span class="lit-number">6.37566443368389627722e+02</span> <span class="comment">// 0xC083EC881375F228</span></code></span>
<span class="codeline" id="line-171"><code>	<a href="../../pkg/math.html#name-rb5" class="ident">rb5</a> = -<span class="lit-number">1.02509513161107724954e+03</span> <span class="comment">// 0xC09004616A2E5992</span></code></span>
<span class="codeline" id="line-172"><code>	<a href="../../pkg/math.html#name-rb6" class="ident">rb6</a> = -<span class="lit-number">4.83519191608651397019e+02</span> <span class="comment">// 0xC07E384E9BDC383F</span></code></span>
<span class="codeline" id="line-173"><code>	<a href="../../pkg/math.html#name-sb1" class="ident">sb1</a> = <span class="lit-number">3.03380607434824582924e+01</span>  <span class="comment">// 0x403E568B261D5190</span></code></span>
<span class="codeline" id="line-174"><code>	<a href="../../pkg/math.html#name-sb2" class="ident">sb2</a> = <span class="lit-number">3.25792512996573918826e+02</span>  <span class="comment">// 0x40745CAE221B9F0A</span></code></span>
<span class="codeline" id="line-175"><code>	<a href="../../pkg/math.html#name-sb3" class="ident">sb3</a> = <span class="lit-number">1.53672958608443695994e+03</span>  <span class="comment">// 0x409802EB189D5118</span></code></span>
<span class="codeline" id="line-176"><code>	<a href="../../pkg/math.html#name-sb4" class="ident">sb4</a> = <span class="lit-number">3.19985821950859553908e+03</span>  <span class="comment">// 0x40A8FFB7688C246A</span></code></span>
<span class="codeline" id="line-177"><code>	<a href="../../pkg/math.html#name-sb5" class="ident">sb5</a> = <span class="lit-number">2.55305040643316442583e+03</span>  <span class="comment">// 0x40A3F219CEDF3BE6</span></code></span>
<span class="codeline" id="line-178"><code>	<a href="../../pkg/math.html#name-sb6" class="ident">sb6</a> = <span class="lit-number">4.74528541206955367215e+02</span>  <span class="comment">// 0x407DA874E79FE763</span></code></span>
<span class="codeline" id="line-179"><code>	<a href="../../pkg/math.html#name-sb7" class="ident">sb7</a> = -<span class="lit-number">2.24409524465858183362e+01</span> <span class="comment">// 0xC03670E242712D62</span></code></span>
<span class="codeline" id="line-180"><code>)</code></span>
<span class="codeline" id="line-181"><code></code></span>
<span class="codeline" id="line-182"><code><span class="comment">// Erf returns the error function of x.</span></code></span>
<span class="codeline" id="line-183"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-184"><code><span class="comment">// Special cases are:</span></code></span>
<span class="codeline" id="line-185"><code><span class="comment">//	Erf(+Inf) = 1</span></code></span>
<span class="codeline" id="line-186"><code><span class="comment">//	Erf(-Inf) = -1</span></code></span>
<span class="codeline" id="line-187"><code><span class="comment">//	Erf(NaN) = NaN</span></code></span>
<span class="codeline" id="line-188"><code><span class="keyword">func</span> <label for="r0" class="ident"><a href="../../pkg/math.html#name-Erf" class="ident">Erf</a></label>(<label for="r1" class="ident">x</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a>) <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-189"><code></code></span>
<span class="codeline" id="line-190"><code><span class="keyword">func</span> <label for="r2" class="ident"><a href="../../pkg/math.html#name-erf" class="ident">erf</a></label>(<label for="r3" class="ident">x</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a>) <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a> {</code></span>
<span class="codeline" id="line-191"><code>	<span class="keyword">const</span> (</code></span>
<span class="codeline" id="line-192"><code>		<label for="r4" class="ident">VeryTiny</label> = <span class="lit-number">2.848094538889218e-306</span> <span class="comment">// 0x0080000000000000</span></code></span>
<span class="codeline" id="line-193"><code>		<label for="r5" class="ident">Small</label>    = <span class="lit-number">1.0</span> / (<span class="lit-number">1</span> &lt;&lt; <span class="lit-number">28</span>)        <span class="comment">// 2**-28</span></code></span>
<span class="codeline" id="line-194"><code>	)</code></span>
<span class="codeline" id="line-195"><code>	<span class="comment">// special cases</span></code></span>
<span class="codeline" id="line-196"><code>	<span class="keyword">switch</span> {</code></span>
<span class="codeline" id="line-197"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-34" class="ident">IsNaN</a>(<label for="r3" class="ident">x</label>):</code></span>
<span class="codeline" id="line-198"><code>		<span class="keyword">return</span> <a href="bits.go.html#line-31" class="ident">NaN</a>()</code></span>
<span class="codeline" id="line-199"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-46" class="ident">IsInf</a>(<label for="r3" class="ident">x</label>, <span class="lit-number">1</span>):</code></span>
<span class="codeline" id="line-200"><code>		<span class="keyword">return</span> <span class="lit-number">1</span></code></span>
<span class="codeline" id="line-201"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-46" class="ident">IsInf</a>(<label for="r3" class="ident">x</label>, -<span class="lit-number">1</span>):</code></span>
<span class="codeline" id="line-202"><code>		<span class="keyword">return</span> -<span class="lit-number">1</span></code></span>
<span class="codeline" id="line-203"><code>	}</code></span>
<span class="codeline" id="line-204"><code>	<label for="r6" class="ident">sign</label> := <a href="../../pkg/builtin.html#name-false" class="ident">false</a></code></span>
<span class="codeline" id="line-205"><code>	<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <span class="lit-number">0</span> {</code></span>
<span class="codeline" id="line-206"><code>		<label for="r3" class="ident">x</label> = -<label for="r3" class="ident">x</label></code></span>
<span class="codeline" id="line-207"><code>		<label for="r6" class="ident">sign</label> = <a href="../../pkg/builtin.html#name-true" class="ident">true</a></code></span>
<span class="codeline" id="line-208"><code>	}</code></span>
<span class="codeline" id="line-209"><code>	<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <span class="lit-number">0.84375</span> { <span class="comment">// |x| &lt; 0.84375</span></code></span>
<span class="codeline" id="line-210"><code>		<span class="keyword">var</span> <label for="r7" class="ident">temp</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-211"><code>		<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <label for="r5" class="ident">Small</label> { <span class="comment">// |x| &lt; 2**-28</span></code></span>
<span class="codeline" id="line-212"><code>			<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <label for="r4" class="ident">VeryTiny</label> {</code></span>
<span class="codeline" id="line-213"><code>				<label for="r7" class="ident">temp</label> = <span class="lit-number">0.125</span> * (<span class="lit-number">8.0</span>*<label for="r3" class="ident">x</label> + <a href="#line-123" class="ident">efx8</a>*<label for="r3" class="ident">x</label>) <span class="comment">// avoid underflow</span></code></span>
<span class="codeline" id="line-214"><code>			} <span class="keyword">else</span> {</code></span>
<span class="codeline" id="line-215"><code>				<label for="r7" class="ident">temp</label> = <label for="r3" class="ident">x</label> + <a href="#line-122" class="ident">efx</a>*<label for="r3" class="ident">x</label></code></span>
<span class="codeline" id="line-216"><code>			}</code></span>
<span class="codeline" id="line-217"><code>		} <span class="keyword">else</span> {</code></span>
<span class="codeline" id="line-218"><code>			<label for="r8" class="ident">z</label> := <label for="r3" class="ident">x</label> * <label for="r3" class="ident">x</label></code></span>
<span class="codeline" id="line-219"><code>			<label for="r9" class="ident">r</label> := <a href="#line-124" class="ident">pp0</a> + <label for="r8" class="ident">z</label>*(<a href="#line-125" class="ident">pp1</a>+<label for="r8" class="ident">z</label>*(<a href="#line-126" class="ident">pp2</a>+<label for="r8" class="ident">z</label>*(<a href="#line-127" class="ident">pp3</a>+<label for="r8" class="ident">z</label>*<a href="#line-128" class="ident">pp4</a>)))</code></span>
<span class="codeline" id="line-220"><code>			<label for="r10" class="ident">s</label> := <span class="lit-number">1</span> + <label for="r8" class="ident">z</label>*(<a href="#line-129" class="ident">qq1</a>+<label for="r8" class="ident">z</label>*(<a href="#line-130" class="ident">qq2</a>+<label for="r8" class="ident">z</label>*(<a href="#line-131" class="ident">qq3</a>+<label for="r8" class="ident">z</label>*(<a href="#line-132" class="ident">qq4</a>+<label for="r8" class="ident">z</label>*<a href="#line-133" class="ident">qq5</a>))))</code></span>
<span class="codeline" id="line-221"><code>			<label for="r11" class="ident">y</label> := <label for="r9" class="ident">r</label> / <label for="r10" class="ident">s</label></code></span>
<span class="codeline" id="line-222"><code>			<label for="r7" class="ident">temp</label> = <label for="r3" class="ident">x</label> + <label for="r3" class="ident">x</label>*<label for="r11" class="ident">y</label></code></span>
<span class="codeline" id="line-223"><code>		}</code></span>
<span class="codeline" id="line-224"><code>		<span class="keyword">if</span> <label for="r6" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-225"><code>			<span class="keyword">return</span> -<label for="r7" class="ident">temp</label></code></span>
<span class="codeline" id="line-226"><code>		}</code></span>
<span class="codeline" id="line-227"><code>		<span class="keyword">return</span> <label for="r7" class="ident">temp</label></code></span>
<span class="codeline" id="line-228"><code>	}</code></span>
<span class="codeline" id="line-229"><code>	<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <span class="lit-number">1.25</span> { <span class="comment">// 0.84375 &lt;= |x| &lt; 1.25</span></code></span>
<span class="codeline" id="line-230"><code>		<label for="r12" class="ident">s</label> := <label for="r3" class="ident">x</label> - <span class="lit-number">1</span></code></span>
<span class="codeline" id="line-231"><code>		<label for="r13" class="ident">P</label> := <a href="#line-135" class="ident">pa0</a> + <label for="r12" class="ident">s</label>*(<a href="#line-136" class="ident">pa1</a>+<label for="r12" class="ident">s</label>*(<a href="#line-137" class="ident">pa2</a>+<label for="r12" class="ident">s</label>*(<a href="#line-138" class="ident">pa3</a>+<label for="r12" class="ident">s</label>*(<a href="#line-139" class="ident">pa4</a>+<label for="r12" class="ident">s</label>*(<a href="#line-140" class="ident">pa5</a>+<label for="r12" class="ident">s</label>*<a href="#line-141" class="ident">pa6</a>)))))</code></span>
<span class="codeline" id="line-232"><code>		<label for="r14" class="ident">Q</label> := <span class="lit-number">1</span> + <label for="r12" class="ident">s</label>*(<a href="#line-142" class="ident">qa1</a>+<label for="r12" class="ident">s</label>*(<a href="#line-143" class="ident">qa2</a>+<label for="r12" class="ident">s</label>*(<a href="#line-144" class="ident">qa3</a>+<label for="r12" class="ident">s</label>*(<a href="#line-145" class="ident">qa4</a>+<label for="r12" class="ident">s</label>*(<a href="#line-146" class="ident">qa5</a>+<label for="r12" class="ident">s</label>*<a href="#line-147" class="ident">qa6</a>)))))</code></span>
<span class="codeline" id="line-233"><code>		<span class="keyword">if</span> <label for="r6" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-234"><code>			<span class="keyword">return</span> -<a href="#line-120" class="ident">erx</a> - <label for="r13" class="ident">P</label>/<label for="r14" class="ident">Q</label></code></span>
<span class="codeline" id="line-235"><code>		}</code></span>
<span class="codeline" id="line-236"><code>		<span class="keyword">return</span> <a href="#line-120" class="ident">erx</a> + <label for="r13" class="ident">P</label>/<label for="r14" class="ident">Q</label></code></span>
<span class="codeline" id="line-237"><code>	}</code></span>
<span class="codeline" id="line-238"><code>	<span class="keyword">if</span> <label for="r3" class="ident">x</label> &gt;= <span class="lit-number">6</span> { <span class="comment">// inf &gt; |x| &gt;= 6</span></code></span>
<span class="codeline" id="line-239"><code>		<span class="keyword">if</span> <label for="r6" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-240"><code>			<span class="keyword">return</span> -<span class="lit-number">1</span></code></span>
<span class="codeline" id="line-241"><code>		}</code></span>
<span class="codeline" id="line-242"><code>		<span class="keyword">return</span> <span class="lit-number">1</span></code></span>
<span class="codeline" id="line-243"><code>	}</code></span>
<span class="codeline" id="line-244"><code>	<label for="r15" class="ident">s</label> := <span class="lit-number">1</span> / (<label for="r3" class="ident">x</label> * <label for="r3" class="ident">x</label>)</code></span>
<span class="codeline" id="line-245"><code>	<span class="keyword">var</span> <label for="r16" class="ident">R</label>, <label for="r17" class="ident">S</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-246"><code>	<span class="keyword">if</span> <label for="r3" class="ident">x</label> &lt; <span class="lit-number">1</span>/<span class="lit-number">0.35</span> { <span class="comment">// |x| &lt; 1 / 0.35  ~ 2.857143</span></code></span>
<span class="codeline" id="line-247"><code>		<label for="r16" class="ident">R</label> = <a href="#line-149" class="ident">ra0</a> + <label for="r15" class="ident">s</label>*(<a href="#line-150" class="ident">ra1</a>+<label for="r15" class="ident">s</label>*(<a href="#line-151" class="ident">ra2</a>+<label for="r15" class="ident">s</label>*(<a href="#line-152" class="ident">ra3</a>+<label for="r15" class="ident">s</label>*(<a href="#line-153" class="ident">ra4</a>+<label for="r15" class="ident">s</label>*(<a href="#line-154" class="ident">ra5</a>+<label for="r15" class="ident">s</label>*(<a href="#line-155" class="ident">ra6</a>+<label for="r15" class="ident">s</label>*<a href="#line-156" class="ident">ra7</a>))))))</code></span>
<span class="codeline" id="line-248"><code>		<label for="r17" class="ident">S</label> = <span class="lit-number">1</span> + <label for="r15" class="ident">s</label>*(<a href="#line-157" class="ident">sa1</a>+<label for="r15" class="ident">s</label>*(<a href="#line-158" class="ident">sa2</a>+<label for="r15" class="ident">s</label>*(<a href="#line-159" class="ident">sa3</a>+<label for="r15" class="ident">s</label>*(<a href="#line-160" class="ident">sa4</a>+<label for="r15" class="ident">s</label>*(<a href="#line-161" class="ident">sa5</a>+<label for="r15" class="ident">s</label>*(<a href="#line-162" class="ident">sa6</a>+<label for="r15" class="ident">s</label>*(<a href="#line-163" class="ident">sa7</a>+<label for="r15" class="ident">s</label>*<a href="#line-164" class="ident">sa8</a>)))))))</code></span>
<span class="codeline" id="line-249"><code>	} <span class="keyword">else</span> { <span class="comment">// |x| &gt;= 1 / 0.35  ~ 2.857143</span></code></span>
<span class="codeline" id="line-250"><code>		<label for="r16" class="ident">R</label> = <a href="#line-166" class="ident">rb0</a> + <label for="r15" class="ident">s</label>*(<a href="#line-167" class="ident">rb1</a>+<label for="r15" class="ident">s</label>*(<a href="#line-168" class="ident">rb2</a>+<label for="r15" class="ident">s</label>*(<a href="#line-169" class="ident">rb3</a>+<label for="r15" class="ident">s</label>*(<a href="#line-170" class="ident">rb4</a>+<label for="r15" class="ident">s</label>*(<a href="#line-171" class="ident">rb5</a>+<label for="r15" class="ident">s</label>*<a href="#line-172" class="ident">rb6</a>)))))</code></span>
<span class="codeline" id="line-251"><code>		<label for="r17" class="ident">S</label> = <span class="lit-number">1</span> + <label for="r15" class="ident">s</label>*(<a href="#line-173" class="ident">sb1</a>+<label for="r15" class="ident">s</label>*(<a href="#line-174" class="ident">sb2</a>+<label for="r15" class="ident">s</label>*(<a href="#line-175" class="ident">sb3</a>+<label for="r15" class="ident">s</label>*(<a href="#line-176" class="ident">sb4</a>+<label for="r15" class="ident">s</label>*(<a href="#line-177" class="ident">sb5</a>+<label for="r15" class="ident">s</label>*(<a href="#line-178" class="ident">sb6</a>+<label for="r15" class="ident">s</label>*<a href="#line-179" class="ident">sb7</a>))))))</code></span>
<span class="codeline" id="line-252"><code>	}</code></span>
<span class="codeline" id="line-253"><code>	<label for="r18" class="ident">z</label> := <a href="unsafe.go.html#line-29" class="ident">Float64frombits</a>(<a href="unsafe.go.html#line-23" class="ident">Float64bits</a>(<label for="r3" class="ident">x</label>) &amp; <span class="lit-number">0xffffffff00000000</span>) <span class="comment">// pseudo-single (20-bit) precision x</span></code></span>
<span class="codeline" id="line-254"><code>	<label for="r19" class="ident">r</label> := <a href="exp.go.html#line-14" class="ident">Exp</a>(-<label for="r18" class="ident">z</label>*<label for="r18" class="ident">z</label>-<span class="lit-number">0.5625</span>) * <a href="exp.go.html#line-14" class="ident">Exp</a>((<label for="r18" class="ident">z</label>-<label for="r3" class="ident">x</label>)*(<label for="r18" class="ident">z</label>+<label for="r3" class="ident">x</label>)+<label for="r16" class="ident">R</label>/<label for="r17" class="ident">S</label>)</code></span>
<span class="codeline" id="line-255"><code>	<span class="keyword">if</span> <label for="r6" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-256"><code>		<span class="keyword">return</span> <label for="r19" class="ident">r</label>/<label for="r3" class="ident">x</label> - <span class="lit-number">1</span></code></span>
<span class="codeline" id="line-257"><code>	}</code></span>
<span class="codeline" id="line-258"><code>	<span class="keyword">return</span> <span class="lit-number">1</span> - <label for="r19" class="ident">r</label>/<label for="r3" class="ident">x</label></code></span>
<span class="codeline" id="line-259"><code>}</code></span>
<span class="codeline" id="line-260"><code></code></span>
<span class="codeline" id="line-261"><code><span class="comment">// Erfc returns the complementary error function of x.</span></code></span>
<span class="codeline" id="line-262"><code><span class="comment">//</span></code></span>
<span class="codeline" id="line-263"><code><span class="comment">// Special cases are:</span></code></span>
<span class="codeline" id="line-264"><code><span class="comment">//	Erfc(+Inf) = 0</span></code></span>
<span class="codeline" id="line-265"><code><span class="comment">//	Erfc(-Inf) = 2</span></code></span>
<span class="codeline" id="line-266"><code><span class="comment">//	Erfc(NaN) = NaN</span></code></span>
<span class="codeline" id="line-267"><code><span class="keyword">func</span> <label for="r20" class="ident"><a href="../../pkg/math.html#name-Erfc" class="ident">Erfc</a></label>(<label for="r21" class="ident">x</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a>) <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-268"><code></code></span>
<span class="codeline" id="line-269"><code><span class="keyword">func</span> <label for="r22" class="ident"><a href="../../pkg/math.html#name-erfc" class="ident">erfc</a></label>(<label for="r23" class="ident">x</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a>) <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a> {</code></span>
<span class="codeline" id="line-270"><code>	<span class="keyword">const</span> <label for="r24" class="ident">Tiny</label> = <span class="lit-number">1.0</span> / (<span class="lit-number">1</span> &lt;&lt; <span class="lit-number">56</span>) <span class="comment">// 2**-56</span></code></span>
<span class="codeline" id="line-271"><code>	<span class="comment">// special cases</span></code></span>
<span class="codeline" id="line-272"><code>	<span class="keyword">switch</span> {</code></span>
<span class="codeline" id="line-273"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-34" class="ident">IsNaN</a>(<label for="r23" class="ident">x</label>):</code></span>
<span class="codeline" id="line-274"><code>		<span class="keyword">return</span> <a href="bits.go.html#line-31" class="ident">NaN</a>()</code></span>
<span class="codeline" id="line-275"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-46" class="ident">IsInf</a>(<label for="r23" class="ident">x</label>, <span class="lit-number">1</span>):</code></span>
<span class="codeline" id="line-276"><code>		<span class="keyword">return</span> <span class="lit-number">0</span></code></span>
<span class="codeline" id="line-277"><code>	<span class="keyword">case</span> <a href="bits.go.html#line-46" class="ident">IsInf</a>(<label for="r23" class="ident">x</label>, -<span class="lit-number">1</span>):</code></span>
<span class="codeline" id="line-278"><code>		<span class="keyword">return</span> <span class="lit-number">2</span></code></span>
<span class="codeline" id="line-279"><code>	}</code></span>
<span class="codeline" id="line-280"><code>	<label for="r25" class="ident">sign</label> := <a href="../../pkg/builtin.html#name-false" class="ident">false</a></code></span>
<span class="codeline" id="line-281"><code>	<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">0</span> {</code></span>
<span class="codeline" id="line-282"><code>		<label for="r23" class="ident">x</label> = -<label for="r23" class="ident">x</label></code></span>
<span class="codeline" id="line-283"><code>		<label for="r25" class="ident">sign</label> = <a href="../../pkg/builtin.html#name-true" class="ident">true</a></code></span>
<span class="codeline" id="line-284"><code>	}</code></span>
<span class="codeline" id="line-285"><code>	<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">0.84375</span> { <span class="comment">// |x| &lt; 0.84375</span></code></span>
<span class="codeline" id="line-286"><code>		<span class="keyword">var</span> <label for="r26" class="ident">temp</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-287"><code>		<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <label for="r24" class="ident">Tiny</label> { <span class="comment">// |x| &lt; 2**-56</span></code></span>
<span class="codeline" id="line-288"><code>			<label for="r26" class="ident">temp</label> = <label for="r23" class="ident">x</label></code></span>
<span class="codeline" id="line-289"><code>		} <span class="keyword">else</span> {</code></span>
<span class="codeline" id="line-290"><code>			<label for="r27" class="ident">z</label> := <label for="r23" class="ident">x</label> * <label for="r23" class="ident">x</label></code></span>
<span class="codeline" id="line-291"><code>			<label for="r28" class="ident">r</label> := <a href="#line-124" class="ident">pp0</a> + <label for="r27" class="ident">z</label>*(<a href="#line-125" class="ident">pp1</a>+<label for="r27" class="ident">z</label>*(<a href="#line-126" class="ident">pp2</a>+<label for="r27" class="ident">z</label>*(<a href="#line-127" class="ident">pp3</a>+<label for="r27" class="ident">z</label>*<a href="#line-128" class="ident">pp4</a>)))</code></span>
<span class="codeline" id="line-292"><code>			<label for="r29" class="ident">s</label> := <span class="lit-number">1</span> + <label for="r27" class="ident">z</label>*(<a href="#line-129" class="ident">qq1</a>+<label for="r27" class="ident">z</label>*(<a href="#line-130" class="ident">qq2</a>+<label for="r27" class="ident">z</label>*(<a href="#line-131" class="ident">qq3</a>+<label for="r27" class="ident">z</label>*(<a href="#line-132" class="ident">qq4</a>+<label for="r27" class="ident">z</label>*<a href="#line-133" class="ident">qq5</a>))))</code></span>
<span class="codeline" id="line-293"><code>			<label for="r30" class="ident">y</label> := <label for="r28" class="ident">r</label> / <label for="r29" class="ident">s</label></code></span>
<span class="codeline" id="line-294"><code>			<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">0.25</span> { <span class="comment">// |x| &lt; 1/4</span></code></span>
<span class="codeline" id="line-295"><code>				<label for="r26" class="ident">temp</label> = <label for="r23" class="ident">x</label> + <label for="r23" class="ident">x</label>*<label for="r30" class="ident">y</label></code></span>
<span class="codeline" id="line-296"><code>			} <span class="keyword">else</span> {</code></span>
<span class="codeline" id="line-297"><code>				<label for="r26" class="ident">temp</label> = <span class="lit-number">0.5</span> + (<label for="r23" class="ident">x</label>*<label for="r30" class="ident">y</label> + (<label for="r23" class="ident">x</label> - <span class="lit-number">0.5</span>))</code></span>
<span class="codeline" id="line-298"><code>			}</code></span>
<span class="codeline" id="line-299"><code>		}</code></span>
<span class="codeline" id="line-300"><code>		<span class="keyword">if</span> <label for="r25" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-301"><code>			<span class="keyword">return</span> <span class="lit-number">1</span> + <label for="r26" class="ident">temp</label></code></span>
<span class="codeline" id="line-302"><code>		}</code></span>
<span class="codeline" id="line-303"><code>		<span class="keyword">return</span> <span class="lit-number">1</span> - <label for="r26" class="ident">temp</label></code></span>
<span class="codeline" id="line-304"><code>	}</code></span>
<span class="codeline" id="line-305"><code>	<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">1.25</span> { <span class="comment">// 0.84375 &lt;= |x| &lt; 1.25</span></code></span>
<span class="codeline" id="line-306"><code>		<label for="r31" class="ident">s</label> := <label for="r23" class="ident">x</label> - <span class="lit-number">1</span></code></span>
<span class="codeline" id="line-307"><code>		<label for="r32" class="ident">P</label> := <a href="#line-135" class="ident">pa0</a> + <label for="r31" class="ident">s</label>*(<a href="#line-136" class="ident">pa1</a>+<label for="r31" class="ident">s</label>*(<a href="#line-137" class="ident">pa2</a>+<label for="r31" class="ident">s</label>*(<a href="#line-138" class="ident">pa3</a>+<label for="r31" class="ident">s</label>*(<a href="#line-139" class="ident">pa4</a>+<label for="r31" class="ident">s</label>*(<a href="#line-140" class="ident">pa5</a>+<label for="r31" class="ident">s</label>*<a href="#line-141" class="ident">pa6</a>)))))</code></span>
<span class="codeline" id="line-308"><code>		<label for="r33" class="ident">Q</label> := <span class="lit-number">1</span> + <label for="r31" class="ident">s</label>*(<a href="#line-142" class="ident">qa1</a>+<label for="r31" class="ident">s</label>*(<a href="#line-143" class="ident">qa2</a>+<label for="r31" class="ident">s</label>*(<a href="#line-144" class="ident">qa3</a>+<label for="r31" class="ident">s</label>*(<a href="#line-145" class="ident">qa4</a>+<label for="r31" class="ident">s</label>*(<a href="#line-146" class="ident">qa5</a>+<label for="r31" class="ident">s</label>*<a href="#line-147" class="ident">qa6</a>)))))</code></span>
<span class="codeline" id="line-309"><code>		<span class="keyword">if</span> <label for="r25" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-310"><code>			<span class="keyword">return</span> <span class="lit-number">1</span> + <a href="#line-120" class="ident">erx</a> + <label for="r32" class="ident">P</label>/<label for="r33" class="ident">Q</label></code></span>
<span class="codeline" id="line-311"><code>		}</code></span>
<span class="codeline" id="line-312"><code>		<span class="keyword">return</span> <span class="lit-number">1</span> - <a href="#line-120" class="ident">erx</a> - <label for="r32" class="ident">P</label>/<label for="r33" class="ident">Q</label></code></span>
<span class="codeline" id="line-313"><code></code></span>
<span class="codeline" id="line-314"><code>	}</code></span>
<span class="codeline" id="line-315"><code>	<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">28</span> { <span class="comment">// |x| &lt; 28</span></code></span>
<span class="codeline" id="line-316"><code>		<label for="r34" class="ident">s</label> := <span class="lit-number">1</span> / (<label for="r23" class="ident">x</label> * <label for="r23" class="ident">x</label>)</code></span>
<span class="codeline" id="line-317"><code>		<span class="keyword">var</span> <label for="r35" class="ident">R</label>, <label for="r36" class="ident">S</label> <a href="../../pkg/builtin.html#name-float64" class="ident">float64</a></code></span>
<span class="codeline" id="line-318"><code>		<span class="keyword">if</span> <label for="r23" class="ident">x</label> &lt; <span class="lit-number">1</span>/<span class="lit-number">0.35</span> { <span class="comment">// |x| &lt; 1 / 0.35 ~ 2.857143</span></code></span>
<span class="codeline" id="line-319"><code>			<label for="r35" class="ident">R</label> = <a href="#line-149" class="ident">ra0</a> + <label for="r34" class="ident">s</label>*(<a href="#line-150" class="ident">ra1</a>+<label for="r34" class="ident">s</label>*(<a href="#line-151" class="ident">ra2</a>+<label for="r34" class="ident">s</label>*(<a href="#line-152" class="ident">ra3</a>+<label for="r34" class="ident">s</label>*(<a href="#line-153" class="ident">ra4</a>+<label for="r34" class="ident">s</label>*(<a href="#line-154" class="ident">ra5</a>+<label for="r34" class="ident">s</label>*(<a href="#line-155" class="ident">ra6</a>+<label for="r34" class="ident">s</label>*<a href="#line-156" class="ident">ra7</a>))))))</code></span>
<span class="codeline" id="line-320"><code>			<label for="r36" class="ident">S</label> = <span class="lit-number">1</span> + <label for="r34" class="ident">s</label>*(<a href="#line-157" class="ident">sa1</a>+<label for="r34" class="ident">s</label>*(<a href="#line-158" class="ident">sa2</a>+<label for="r34" class="ident">s</label>*(<a href="#line-159" class="ident">sa3</a>+<label for="r34" class="ident">s</label>*(<a href="#line-160" class="ident">sa4</a>+<label for="r34" class="ident">s</label>*(<a href="#line-161" class="ident">sa5</a>+<label for="r34" class="ident">s</label>*(<a href="#line-162" class="ident">sa6</a>+<label for="r34" class="ident">s</label>*(<a href="#line-163" class="ident">sa7</a>+<label for="r34" class="ident">s</label>*<a href="#line-164" class="ident">sa8</a>)))))))</code></span>
<span class="codeline" id="line-321"><code>		} <span class="keyword">else</span> { <span class="comment">// |x| &gt;= 1 / 0.35 ~ 2.857143</span></code></span>
<span class="codeline" id="line-322"><code>			<span class="keyword">if</span> <label for="r25" class="ident">sign</label> &amp;&amp; <label for="r23" class="ident">x</label> &gt; <span class="lit-number">6</span> {</code></span>
<span class="codeline" id="line-323"><code>				<span class="keyword">return</span> <span class="lit-number">2</span> <span class="comment">// x &lt; -6</span></code></span>
<span class="codeline" id="line-324"><code>			}</code></span>
<span class="codeline" id="line-325"><code>			<label for="r35" class="ident">R</label> = <a href="#line-166" class="ident">rb0</a> + <label for="r34" class="ident">s</label>*(<a href="#line-167" class="ident">rb1</a>+<label for="r34" class="ident">s</label>*(<a href="#line-168" class="ident">rb2</a>+<label for="r34" class="ident">s</label>*(<a href="#line-169" class="ident">rb3</a>+<label for="r34" class="ident">s</label>*(<a href="#line-170" class="ident">rb4</a>+<label for="r34" class="ident">s</label>*(<a href="#line-171" class="ident">rb5</a>+<label for="r34" class="ident">s</label>*<a href="#line-172" class="ident">rb6</a>)))))</code></span>
<span class="codeline" id="line-326"><code>			<label for="r36" class="ident">S</label> = <span class="lit-number">1</span> + <label for="r34" class="ident">s</label>*(<a href="#line-173" class="ident">sb1</a>+<label for="r34" class="ident">s</label>*(<a href="#line-174" class="ident">sb2</a>+<label for="r34" class="ident">s</label>*(<a href="#line-175" class="ident">sb3</a>+<label for="r34" class="ident">s</label>*(<a href="#line-176" class="ident">sb4</a>+<label for="r34" class="ident">s</label>*(<a href="#line-177" class="ident">sb5</a>+<label for="r34" class="ident">s</label>*(<a href="#line-178" class="ident">sb6</a>+<label for="r34" class="ident">s</label>*<a href="#line-179" class="ident">sb7</a>))))))</code></span>
<span class="codeline" id="line-327"><code>		}</code></span>
<span class="codeline" id="line-328"><code>		<label for="r37" class="ident">z</label> := <a href="unsafe.go.html#line-29" class="ident">Float64frombits</a>(<a href="unsafe.go.html#line-23" class="ident">Float64bits</a>(<label for="r23" class="ident">x</label>) &amp; <span class="lit-number">0xffffffff00000000</span>) <span class="comment">// pseudo-single (20-bit) precision x</span></code></span>
<span class="codeline" id="line-329"><code>		<label for="r38" class="ident">r</label> := <a href="exp.go.html#line-14" class="ident">Exp</a>(-<label for="r37" class="ident">z</label>*<label for="r37" class="ident">z</label>-<span class="lit-number">0.5625</span>) * <a href="exp.go.html#line-14" class="ident">Exp</a>((<label for="r37" class="ident">z</label>-<label for="r23" class="ident">x</label>)*(<label for="r37" class="ident">z</label>+<label for="r23" class="ident">x</label>)+<label for="r35" class="ident">R</label>/<label for="r36" class="ident">S</label>)</code></span>
<span class="codeline" id="line-330"><code>		<span class="keyword">if</span> <label for="r25" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-331"><code>			<span class="keyword">return</span> <span class="lit-number">2</span> - <label for="r38" class="ident">r</label>/<label for="r23" class="ident">x</label></code></span>
<span class="codeline" id="line-332"><code>		}</code></span>
<span class="codeline" id="line-333"><code>		<span class="keyword">return</span> <label for="r38" class="ident">r</label> / <label for="r23" class="ident">x</label></code></span>
<span class="codeline" id="line-334"><code>	}</code></span>
<span class="codeline" id="line-335"><code>	<span class="keyword">if</span> <label for="r25" class="ident">sign</label> {</code></span>
<span class="codeline" id="line-336"><code>		<span class="keyword">return</span> <span class="lit-number">2</span></code></span>
<span class="codeline" id="line-337"><code>	}</code></span>
<span class="codeline" id="line-338"><code>	<span class="keyword">return</span> <span class="lit-number">0</span></code></span>
<span class="codeline" id="line-339"><code>}</code></span>
</pre><pre id="footer">
<table><tr><td><img src="../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.4.0</i>. (GOOS=linux GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>