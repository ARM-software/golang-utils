Fixed `lock file` race condition reported by golang race detector
